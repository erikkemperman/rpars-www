!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"86oW":function(r,n,s){"use strict";s.r(n),s.d(n,"TabGroupsPageModule",(function(){return w}));var i=s("TEn/"),o=s("tyNb"),a=s("ofXK"),c=s("3Pt+"),u=s("mrSG"),b=s("AytR"),l=s("fXoL"),d=s("pRC4"),p=s("fJnV");function m(e,t){1&e&&(l.Mb(0,"div"),l.hc(1," Please log in on the Profile tab "),l.Lb())}function h(e,t){if(1&e){var r=l.Nb();l.Mb(0,"ion-item"),l.Mb(1,"ion-label",9),l.hc(2),l.Mb(3,"b"),l.hc(4),l.Lb(),l.Lb(),l.Mb(5,"ion-button",12),l.Ub("click",(function(){l.dc(r);var e=t.$implicit,n=l.Wb().$implicit,s=l.Wb().$implicit;return l.Wb(2).removeUser(s,n,e)})),l.Ib(6,"ion-icon",13),l.Lb(),l.Lb()}if(2&e){var n=t.$implicit;l.xb(2),l.jc(" User #",n.user_id," "),l.xb(2),l.ic(n.user_email)}}function g(e,t){if(1&e&&(l.Mb(0,"ion-select-option",14),l.hc(1),l.Mb(2,"b"),l.hc(3),l.Lb(),l.Lb()),2&e){var r=t.$implicit;l.ac("value",r.user_id),l.xb(1),l.jc(" User #",r.user_id," "),l.xb(2),l.ic(r.user_email)}}function f(e,t){if(1&e){var r=l.Nb();l.Kb(0),l.Mb(1,"ion-list-header"),l.Mb(2,"ion-label"),l.hc(3),l.Mb(4,"b"),l.hc(5),l.Lb(),l.Lb(),l.Lb(),l.Mb(6,"ion-item"),l.Mb(7,"ion-list",7),l.gc(8,h,7,2,"ion-item",6),l.Mb(9,"ion-item",8),l.Mb(10,"ion-label",9),l.Mb(11,"i"),l.hc(12,"Add a user to group "),l.Mb(13,"b"),l.hc(14),l.Lb(),l.hc(15,":"),l.Lb(),l.Lb(),l.Mb(16,"ion-select",10),l.Ub("ionChange",(function(e){l.dc(r);var n=t.$implicit;return l.Wb(3).addUser(n.group_id,e.detail.value)})),l.gc(17,g,4,3,"ion-select-option",11),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Jb()}if(2&e){var n=t.$implicit,s=l.Wb(3);l.xb(3),l.jc("Group #",n.group_id," "),l.xb(2),l.ic(n.group_name),l.xb(3),l.Zb("ngForOf",n.group_members),l.xb(1),l.Zb("disabled",0===s.unassigned.length),l.xb(5),l.ic(n.group_name),l.xb(3),l.Zb("ngForOf",s.unassigned)}}function v(e,t){if(1&e&&(l.Kb(0),l.Mb(1,"ion-list-header"),l.Mb(2,"ion-label"),l.hc(3),l.Mb(4,"b"),l.hc(5),l.Lb(),l.Lb(),l.Lb(),l.Mb(6,"ion-item"),l.Mb(7,"ion-list",7),l.gc(8,f,18,6,"ng-container",6),l.Lb(),l.Lb(),l.Jb()),2&e){var r=t.$implicit;l.xb(3),l.jc("Project #",r.project_id," "),l.xb(2),l.ic(r.project_name),l.xb(3),l.Zb("ngForOf",r.project_members)}}function x(e,t){if(1&e&&(l.Mb(0,"div"),l.Mb(1,"ion-list",5),l.gc(2,v,9,3,"ng-container",6),l.Lb(),l.Lb()),2&e){var r=l.Wb();l.xb(2),l.Zb("ngForOf",r.members)}}var O,R,T,k=((O=function(){function r(t,n,s,i,o){e(this,r),this.alertController=t,this.loadingController=n,this.toastController=s,this.sessionService=i,this.memberService=o,this.members=[],this.unassigned=[],this.checker=null}var n,s,i;return n=r,(s=[{key:"ngOnInit",value:function(){console.log("Groups tab: ngOnInit")}},{key:"ionViewWillEnter",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Groups tab: will enter"),e.next=3,this.checkStatus();case 3:this.checker=setInterval((function(){return Object(u.a)(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkStatus();case 2:case"end":return e.stop()}}),e,this)})))}),b.a.PERIOD_REENTER);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"ionViewWillLeave",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Groups tab: will leave"),this.checker&&clearInterval(this.checker);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"checkStatus",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Groups tab: check status"),e.next=3,this.sessionService.isLoggedIn();case 3:return this.loggedIn=e.sent,e.next=6,this.refreshMembers();case 6:case"end":return e.stop()}}),e,this)})))}},{key:"refreshMembers",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.loggedIn){e.next=37;break}return e.next=3,this.loadingController.create({message:"Loading projects and groups...",backdropDismiss:!1,translucent:!0});case 3:return t=e.sent,e.next=6,t.present();case 6:return this.members=[],this.unassigned=[],e.prev=8,e.next=11,this.memberService.getMembers();case 11:this.members=e.sent,console.log("Loaded members:",this.members),e.next=22;break;case 15:return e.prev=15,e.t0=e.catch(8),t.dismiss(),e.next=20,this.toastController.create({message:""+e.t0,duration:b.a.TOAST_DURATION_ERROR,position:b.a.TOAST_POSITION,color:"danger"});case 20:return e.sent.present(),e.abrupt("return",!1);case 22:return e.prev=22,e.next=25,this.memberService.getUnassignedUsers();case 25:this.unassigned=e.sent,console.log("Unassigned users:",this.unassigned),e.next=36;break;case 29:return e.prev=29,e.t1=e.catch(22),t.dismiss(),e.next=34,this.toastController.create({message:""+e.t1,duration:b.a.TOAST_DURATION_ERROR,position:b.a.TOAST_POSITION,color:"danger"});case 34:return e.sent.present(),e.abrupt("return",!1);case 36:return e.abrupt("return",(t.dismiss(),!0));case 37:case"end":return e.stop()}}),e,this,[[8,15],[22,29]])})))}},{key:"addUser",value:function(e,t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.loadingController.create({message:"Adding user(s) to group...",backdropDismiss:!1,translucent:!0});case 2:return n=r.sent,r.next=5,n.present();case 5:return s=t.map((function(e){return parseInt(e)})),r.prev=6,r.next=9,this.memberService.addUsers(e,s);case 9:r.next=18;break;case 11:return r.prev=11,r.t0=r.catch(6),n.dismiss(),r.next=16,this.toastController.create({message:""+r.t0,duration:b.a.TOAST_DURATION_ERROR,position:b.a.TOAST_POSITION,color:"danger"});case 16:return r.sent.present(),r.abrupt("return",!1);case 18:return n.dismiss(),r.next=21,this.toastController.create({message:"Users added to group",duration:b.a.TOAST_DURATION_SUCCESS,position:b.a.TOAST_POSITION,color:"success"});case 21:return r.sent.present(),r.next=24,this.refreshMembers();case 24:return r.abrupt("return",r.sent);case 25:case"end":return r.stop()}}),r,this,[[6,11]])})))}},{key:"removeUser",value:function(e,t,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var s,i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Promise((function(n){return Object(u.a)(i,void 0,void 0,regeneratorRuntime.mark((function s(){var i;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.alertController.create({header:"Alert!",subHeader:"Are you sure?",message:"Remove user <b>".concat(r.user_email,"</b><br />from group <b>").concat(t.group_name,"</b><br />in project <b>").concat(e.project_name,"</b>?"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){return n(!1)}},{text:"Confirm",role:"confirm",cssClass:"secondary",handler:function(){return n(!0)}}]});case 2:return i=s.sent,s.next=5,i.present();case 5:case"end":return s.stop()}}),s,this)})))}));case 2:if(n.sent){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,this.loadingController.create({message:"Removing user ".concat(r.user_email,"..."),backdropDismiss:!1,translucent:!0});case 6:return s=n.sent,n.next=9,s.present();case 9:return n.prev=9,n.next=12,this.memberService.removeUser(r.user_id);case 12:n.next=21;break;case 14:return n.prev=14,n.t0=n.catch(9),s.dismiss(),n.next=19,this.toastController.create({message:""+n.t0,duration:b.a.TOAST_DURATION_ERROR,position:b.a.TOAST_POSITION,color:"danger"});case 19:return n.sent.present(),n.abrupt("return",!1);case 21:return s.dismiss(),n.next=24,this.toastController.create({message:"User removed from group",duration:b.a.TOAST_DURATION_SUCCESS,position:b.a.TOAST_POSITION,color:"success"});case 24:return n.sent.present(),n.next=27,this.refreshMembers();case 27:return n.abrupt("return",n.sent);case 28:case"end":return n.stop()}}),n,this,[[9,14]])})))}}])&&t(n.prototype,s),i&&t(n,i),r}()).\u0275fac=function(e){return new(e||O)(l.Hb(i.a),l.Hb(i.A),l.Hb(i.E),l.Hb(d.a),l.Hb(p.a))},O.\u0275cmp=l.Bb({type:O,selectors:[["app-tab-groups"]],decls:11,vars:4,consts:[[3,"translucent"],[3,"fullscreen"],["collapse","condense"],["size","large"],[4,"ngIf"],["lines","full",2,"width","100%"],[4,"ngFor","ngForOf"],[2,"width","100%"],[3,"disabled"],["position","stacked"],["multiple","true",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],["slot","end","fill","none",3,"click"],["slot","icon-only","name","trash-outline"],[3,"value"]],template:function(e,t){1&e&&(l.Mb(0,"ion-header",0),l.Mb(1,"ion-toolbar"),l.Mb(2,"ion-title"),l.hc(3," Groups "),l.Lb(),l.Lb(),l.Lb(),l.Mb(4,"ion-content",1),l.Mb(5,"ion-header",2),l.Mb(6,"ion-toolbar"),l.Mb(7,"ion-title",3),l.hc(8,"Groups"),l.Lb(),l.Lb(),l.Lb(),l.gc(9,m,2,0,"div",4),l.gc(10,x,3,1,"div",4),l.Lb()),2&e&&(l.Zb("translucent",!0),l.xb(4),l.Zb("fullscreen",!0),l.xb(5),l.Zb("ngIf",!t.loggedIn),l.xb(1),l.Zb("ngIf",t.loggedIn))},directives:[i.i,i.x,i.w,i.g,a.i,i.n,a.h,i.o,i.m,i.l,i.r,i.C,i.d,i.j,i.s],styles:[""]}),O),M=[{path:"",component:k}],_=((T=function t(){e(this,t)}).\u0275mod=l.Fb({type:T}),T.\u0275inj=l.Eb({factory:function(e){return new(e||T)},imports:[[o.i.forChild(M)],o.i]}),T),w=((R=function t(){e(this,t)}).\u0275mod=l.Fb({type:R}),R.\u0275inj=l.Eb({factory:function(e){return new(e||R)},imports:[[i.y,a.b,c.a,o.i.forChild([{path:"",component:k}]),_]]}),R)}}])}();